{"version":3,"sources":["componentSuper.js"],"names":["componentSuper","cc","Class","extends","Component","ctor","eventList","registerButtonTouchEvent","node","child","children","length","i","childNode","name","slice","buttonTouchEvent","on","getNodeByName","child_name","next_child","registerTouchEvent","size","director","getWinSize","width","height","touchBegan","event","stopPropagation","Node","EventType","TOUCH_START","touchMove","TOUCH_MOVE","touchEnded","TOUCH_END","touchCancel","TOUCH_CANCEL","createPrefab","prefab","parent","instantiate","addEvent","callback","systemEvent","dispatchEvent","params","eventCustom","Event","EventCustom","setUserData","onDestroy","eventData","off","module","exports"],"mappings":"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","file":"componentSuper.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\nvar componentSuper = cc.Class({\r\n    extends: cc.Component,\r\n    ctor:function(){\r\n\r\n        //事件列表\r\n        this.eventList = [];\r\n    },\r\n    //注册所有按钮点击事件\r\n    registerButtonTouchEvent:function(node) {       \r\n        var child = node.children;\r\n        if(child.length > 0 ){\r\n            for(var i= 0; i < child.length;i++){\r\n                var childNode = child[i];\r\n                var name = childNode.name;\r\n                if(name.slice(0,3) === \"btn\" || name.slice(0,6) === \"button\"){\r\n                    if(this.buttonTouchEvent){//把function转Boolean 得到 True\r\n                        //在节点上注册指定类型的回调函数\r\n                        childNode.on('click', this.buttonTouchEvent, this);\r\n                    }\r\n                }\r\n                //cc.log(\">>>>>>>>>>>>>>子节点数量\",childNode.children.length);\r\n                if(childNode.children.length > 0 ){\r\n                    this.registerButtonTouchEvent(childNode);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //获取对象\r\n    getNodeByName:function(name,node) {\r\n        var node = node ? node : this.node\r\n        if(node.name === name){\r\n            return node;\r\n        }\r\n        var children = node.children;\r\n        if (children.length){\r\n            for(var i = 0; i < children.length;i++){\r\n                var child = children[i];\r\n                var child_name = child.name;\r\n                if (child_name === name){\r\n                    return child;\r\n                }\r\n                var next_child = this.getNodeByName(name,child)\r\n                if (next_child){\r\n                    return next_child;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    //注册触摸事件\r\n    registerTouchEvent:function(){\r\n        //event.getLocationX()\r\n        //event.getLocationY()\r\n        var node = this.node;\r\n        var size = cc.director.getWinSize();\r\n        node.width = size.width;\r\n        node.height = size.height;\r\n        //触摸开始\r\n        var touchBegan = function(event){\r\n            event.stopPropagation();\r\n            if(this.touchBegan){\r\n                this.touchBegan(event);\r\n            }\r\n        }\r\n        node.on(cc.Node.EventType.TOUCH_START,touchBegan,this);\r\n        //触摸移动\r\n        var touchMove = function(event){\r\n            event.stopPropagation();\r\n            if(this.touchMove){\r\n                this.touchMove(event);\r\n            }\r\n        }\r\n        node.on(cc.Node.EventType.TOUCH_MOVE,touchMove,this);\r\n        //触摸结束\r\n        var touchEnded = function(event){\r\n            event.stopPropagation();\r\n            if(this.touchEnded){\r\n                this.touchEnded(event);\r\n            }\r\n        }\r\n        node.on(cc.Node.EventType.TOUCH_END,touchEnded,this)\r\n        //触摸离开屏幕\r\n        var touchCancel = function(event){\r\n            event.stopPropagation();\r\n            if(this.touchCancel){\r\n                this.touchCancel(event);\r\n            }\r\n        }\r\n        node.on(cc.Node.EventType.TOUCH_CANCEL,touchCancel,this)\r\n    },\r\n    //创建预制资源\r\n    createPrefab:function(prefab,parent){\r\n        if (!prefab) return;\r\n        var parent = parent ? parent : this.node;\r\n        var prefab =  cc.instantiate(prefab);\r\n        prefab.parent = parent;\r\n        return prefab;\r\n    },\r\n    //添加监听事件\r\n    addEvent:function(name,callback){\r\n        this.eventList[this.eventList.length] = {name:name,callback:callback};\r\n        cc.systemEvent.on(name,callback, this);\r\n    },\r\n    //派发事件\r\n    dispatchEvent:function(name,params){\r\n        var eventCustom = new cc.Event.EventCustom(name,true);\r\n        eventCustom.setUserData(params)\r\n        cc.systemEvent.dispatchEvent(eventCustom);\r\n        //event参数说明 \r\n        //event.type:事件名字\r\n        //event.bubbles:表示该事件是否进行冒泡。\r\n        //event.setUserData:设置事件参数\r\n        //event.getUserData:获取事件参数\r\n    },\r\n    onDestroy:function(){\r\n        //关闭事件\r\n        for(var i = 0 ; i < this.eventList.length; i++){\r\n            var eventData = this.eventList[i];\r\n            cc.systemEvent.off(eventData.name,eventData.callback, this);\r\n        }\r\n    },\r\n    \r\n});\r\n\r\nmodule.exports = componentSuper;\r\n"]}